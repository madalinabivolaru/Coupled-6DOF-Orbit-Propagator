#Envisat Data at 30 min timesteps
#Start Time: 2014-Mar-11 00:00:00.0000 TDB 
using Plots
using CSV
using DataFrames
using Interpolations
using CubicSplines
using LinearAlgebra

X  = [-2.402809058043280E+03,-3.789904283416959E+03, 4.716723832273948E+03, 
     9.069148013040613E+02, -5.276962048809075E+03, 2.306896415239559E+03, 
     3.864768525461669E+03, -4.668493512608412E+03, -1.025036462191081E+03, 
     5.295818020204037E+03, -2.207897360315789E+03, -3.956314281955199E+03]
Y = [-1.874768763045400E+03, 5.650462695442000E+03, -1.586927878746532E+03,
     -4.690880935010720E+03, 4.429834547627942E+03, 1.977006842915589E+03,
     -5.647923557796182E+03, 1.449675764353658E+03, 4.748108619588123E+03,
     -4.363857998054837E+03, -2.099934053068593E+03, 5.626406784151446E+03]
Z = [-6.470568913456360E+03, 2.170346359188844E+03, 5.121721428361601E+03,
     -5.322319361948230E+03, -1.902045064772732E+03, 6.457681686004908E+03,
     -2.073060184637103E+03, -5.219644403576160E+03, 5.228807096582866E+03,
     1.996989879066707E+03, -6.470876931721111E+03, 1.923070290074096E+03]
VX = [-4.951358974727093E+00, 3.905748863374637E+00, 2.577504909132809E+00,
     -5.472472863932094E+00, 7.587089882620012E-01, 5.020210759106030E+00,
     -3.830162876415030E+00, -2.689974200509083E+00, 5.470748884012937E+00,
     -6.559934583082142E-01, -5.067862956199384E+00, 3.746879580964330E+00]
VY = [5.569741482201460E+00, 1.609714941518696E-01, -5.677193445091623E+00,
     3.299027701507035E+00, 3.665354001730498E+00, -5.533620230310372E+00,
     -2.774445693924354E-01, 5.700255380924174E+00, -3.191751113611070E+00,
     -3.751128955272174E+00, 5.468077310516748E+00, 4.167416073312507E-01]
VZ = [2.254714231573829E-01, 6.368104122470288E+00, -4.119127730004954E+00,
     -3.841576816263927E+00, 6.463724554742325E+00, -9.465949511072091E-02,
     -6.398818303931944E+00, 3.994070085920035E+00, 3.963985606420180E+00,
     -6.426544784949086E+00, -4.487672330314973E-02,6.451370848828271E+00]
T = LinRange(0, 21600, 12)
#plot(T, [X, Y,Z])

AMATO = CSV.read("AMATO.csv", header=false, DataFrame)[1:182627,:]
H3 =  CSV.read("horizons3.csv", header=false, DataFrame)[:,:]
Th = LinRange(0, 8928*300, 8929)
Xsp = CubicSpline(AMATO[:,8],AMATO[:,2])
Ysp = CubicSpline(AMATO[:,8],AMATO[:,3])
Zsp = CubicSpline(AMATO[:,8],AMATO[:,4])
vxsp = CubicSpline(AMATO[:,8],AMATO[:,5])
vysp = CubicSpline(AMATO[:,8],AMATO[:,6])
vzsp = CubicSpline(AMATO[:,8],AMATO[:,7])
AMA = Xsp[Th]
#plot(AMATO[:,8],AMATO[:,2])
#l = @layout [a b; c d; e f]
l = @layout[a ;b;c]
p1=plot(Th[:], abs.(H3[:,1] - AMA[:]), label = "rx", xlabel = "time, s", ylabel = "Position, km")
p2=plot(Th[:], abs.(H3[:,2] - Ysp[Th]), label = "ry",xlabel = "time, s", ylabel = "Position, km")
p3=plot(Th[:], abs.(H3[:,3] - Zsp[Th]), label = "rz",xlabel = "time, s", ylabel = "Position, km")
p4=plot(Th[:], abs.(H3[:,4] - vxsp[Th]), label = "vx",xlabel = "time, s", ylabel = "velocity, km/s")
p5=plot(Th[:], abs.(H3[:,5] - vysp[Th]), label = "vy",xlabel = "time, s", ylabel = "velocity, km/s")
p6=plot(Th[:], abs.(H3[:,6] - vzsp[Th]), label = "vz",xlabel = "time, s", ylabel = "velocity, km/s")
#plot(p1,p4,p2,p5,p3,p6,layout = l)
plot(p4,p5,p6,layout = l)